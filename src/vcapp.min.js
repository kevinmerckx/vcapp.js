define([],function(){"use strict";var e={app:void 0,apps:{},viewControllers:{}};return e.registerApp=function(e,o,n){this.apps[e]={maker:o,options:n}},e.registerViewController=function(e,o,n){this.viewControllers[e]={maker:o,options:n}},e.createViewController=function(e,o){if(this.viewControllers[e]){var n={};for(var t in this.viewControllers[e].options)n[t]=this.viewControllers[e].options[t];for(var t in o)n[t]=o[t];return this.viewControllers[e].maker(n)}},e.makeApplication=function(o,n){n=n||{},o=o||{};var t;return n.willLaunch=o.willLaunch||function(){},n.didLaunch=o.didLaunch||function(){},n.launch=function(){n.willLaunch(),n.setRootViewController(o.rootViewController&&e.viewControllers[o.rootViewController]?e.createViewController(o.rootViewController):new e.ViewController),n.didLaunch()},n.getRootViewController=function(){return t},n.setRootViewController=function(e){t&&t.willUnappear(),t&&t.unloadView(),t&&t.didUnappear(),t=e,e&&e.willAppear(),e&&e.loadView(document.querySelector("body"),function(){e&&e.didAppear()})},n},e.makeViewController=function(o,n){return n=n||{},n.options=o||{},n.willLoad=n.options.willLoad||function(){},n.didLoad=n.options.didLoad||function(){},n.willUnload=n.options.willUnload||function(){},n.didUnload=n.options.didUnload||function(){},n.willAppear=n.options.willAppear||function(){},n.didAppear=n.options.didAppear||function(){},n.willUnappear=n.options.willUnappear||function(){},n.didUnappear=n.options.didUnappear||function(){},n.element=void 0,n.uiElements={},n.isLoaded=!1,n.loadView=function(o,t){n.element=o,n.willLoad(),n.options.template?e.loadTemplate(n.options.template).into(n.element,function(){n.isLoaded=!0,Array.prototype.slice.call(n.element.querySelectorAll("*[id]")).forEach(function(e){n.uiElements[e.getAttribute("id")]=e}),t&&t(),n.didLoad()}):n.didLoad()},n.unloadView=function(e){n.isLoaded=!1,n.willUnload(),e&&e(),n.didUnload()},n},e.makeModalViewController=function(o,n){return n=e.makeViewController(o,n),n.open=n.options.open||function(){},n.close=n.options.close||function(){},n.willOpen=n.options.willOpen||function(){},n.didOpen=n.options.didOpen||function(){},n.willClose=n.options.willClose||function(){},n.didClose=n.options.didClose||function(){},n},e.makeNavigationViewController=function(o,n){n=e.makeViewController(o,n),n.timeBeforeUnloadingView=n.options.timeBeforeUnloadingView||100,n.willChangeTop=n.options.willChangeTop||function(){},n.didChangeTop=n.options.didChangeTop||function(){},n.willPush=n.options.willPush||function(){},n.didPush=n.options.didPush||function(){},n.willPop=n.options.willPop||function(){},n.didPop=n.options.didPop||function(){},n.contentElement,n.history=[];var t=n.loadView;n.loadView=function(o){t.call(n,o,function(){n.contentElement=n.getContentElement();var o=n.getTopViewController();o&&n.push(e.createViewController(o))})};var i=n.unloadView;return n.unloadView=function(){n.history.forEach(function(e){e.willUnappear(),e.willUnload()}),i.call(n,function(){n.history.forEach(function(e){e.didUnappear(),e.didUnload()})})},n.getContentElement=function(){return n.element.querySelector("view")},n.getTopViewController=function(){var e=n.element.querySelector("view").getAttribute("top");return n.contentElement.removeAttribute("top"),e},n.push=function(e){var o=n.top();e.navigationViewController=n,n.willPush(e),n.willChangeTop(),e.willAppear(),o&&o.willUnappear(),n.history.push(e);var t=document.createElement("div");e.loadView(t,function(){n.contentElement.appendChild(t),n.didPush(e),n.didChangeTop(),e.didAppear(),o&&o.didUnappear()})},n.pop=function(){var e=n.top();if(e){n.willPop(e),n.willChangeTop(),n.history.pop();var o=n.top();o&&o.willAppear(),n.didPop(e),n.didChangeTop(),o&&o.didAppear(),setTimeout(function(){e.willUnload(),e.element.remove(),e.didUnload()},n.timeBeforeUnloadingView)}},n.top=function(){return 0!==n.history.length?n.history[n.history.length-1]:void 0},n},e.makePopupViewController=function(o,n){return n=e.makeViewController(o,n),n.parentViewController=void 0,n.openIn=n.options.openIn||function(e){n.parentViewController=e,n.willOpen(),n.didOpen()},n.close=n.options.close||function(){n.willClose(),n.didClose()},n.willOpen=n.options.willOpen||function(){},n.didOpen=n.options.didOpen||function(){},n.willClose=n.options.willClose||function(){},n.didClose=n.options.didClose||function(){},n},e.makeTabsViewController=function(o,n){n=e.makeViewController(o,n),n.willSelect=o.willSelect||function(){},n.didSelect=o.didSelect||function(){},n.willUnselect=o.willUnselect||function(){},n.didUnselect=o.didUnselect||function(){},n.contentElement=void 0,n.tabs=[],n.selected=-1;var t=n.loadView;n.loadView=function(o){t.call(n,o,function(){n.contentElement=n.element.querySelector("view"),n.element.forEach("tabs tab",function(o){n.tabs.push({label:o.getAttribute("label"),icon:o.getAttribute("icon"),viewController:e.createViewController(o.getAttribute("root")),container:document.createElement("div"),isLoaded:!1})}),n.element.forEach("tabs",function(e){e.remove()})})};var i=n.unloadView;return n.unloadView=function(){n.tabs.forEach(function(e){e.viewController.willUnappear(),e.viewController.willUnload()}),i.call(n,function(){n.tabs.forEach(function(e){e.viewController.didUnappear(),e.viewController.didUnload()})})},n.select=function(e){var o=n.selected;0>e&&e>=n.tabs.length&&e!=n.selected||(o>=0&&n.willUnselect(o),n.willSelect(e),n.tabs[e].viewController.willAppear(),o>=0&&n.tabs[o].viewController.willUnappear(),n.tabs[e].isLoaded||(n.contentElement.appendChild(n.tabs[e].container),n.tabs[e].viewController.loadView(n.tabs[e].container),n.tabs[e].isLoaded=!0),o>=0&&n.didUnselect(o),n.selected=e,n.didSelect(e),n.tabs[e].viewController.didAppear(),o>=0&&n.tabs[o].viewController.didUnappear())},n},e.loadTemplate=function(e){return{into:function(o,n){var t=new XMLHttpRequest;t.onload=function(){o.innerHTML=this.responseText,n&&n()},t.open("get",e,!0),t.send()}}},HTMLElement.prototype.forEach=function(e,o){var n=this.querySelectorAll(e);Array.prototype.slice.call(n).forEach(o)},e});