"use strict";document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("body").getAttribute("app");document.querySelector("body").removeAttribute("app");var t=WebApp.apps[e].maker,i=t(WebApp.apps[e].options);WebApp.app=i,i.launch()});var WebApp={app:void 0,apps:{},viewControllers:{}};WebApp.registerApp=function(e,t,i){this.apps[e]={maker:t,options:i}},WebApp.registerViewController=function(e,t,i){this.viewControllers[e]={maker:t,options:i}},WebApp.createViewController=function(e,t){if(this.viewControllers[e]){var i={};for(var n in this.viewControllers[e].options)i[n]=this.viewControllers[e].options[n];for(var n in t)i[n]=t[n];return this.viewControllers[e].maker(i)}},WebApp.makeApplication=function(e,t){t=t||{},e=e||{};var i;return t.willLaunch=e.willLaunch||function(){},t.didLaunch=e.didLaunch||function(){},t.launch=function(){t.willLaunch(),t.setRootViewController(e.rootViewController&&WebApp.viewControllers[e.rootViewController]?WebApp.createViewController(e.rootViewController):new WebApp.ViewController),t.didLaunch()},t.getRootViewController=function(){return i},t.setRootViewController=function(e){i&&i.unloadView(),i=e,e&&e.willAppear(),e.loadView(document.querySelector("body"),function(){e&&e.didAppear()})},t},WebApp.makeViewController=function(e,t){return t=t||{},t.options=e||{},t.willLoad=t.options.willLoad||function(){},t.didLoad=t.options.didLoad||function(){},t.willAppear=t.options.willAppear||function(){},t.didAppear=t.options.didAppear||function(){},t.willUnload=t.options.willUnload||function(){},t.didUnload=t.options.didUnload||function(){},t.element=void 0,t.uiElements={},t.isLoaded=!1,t.loadView=function(e,i){t.element=e,t.willLoad(),t.options.template?WebApp.loadTemplate(t.options.template).into(t.element,function(){t.isLoaded=!0,Array.prototype.slice.call(t.element.querySelectorAll("*[id]")).forEach(function(e){t.uiElements[e.getAttribute("id")]=e}),i&&i(),t.didLoad()}):t.didLoad()},t.unloadView=function(e){t.isLoaded=!1,t.willUnload(),t.element.remove(),e&&e(),t.didUnload()},t},WebApp.makeTabsViewController=function(e,t){t=WebApp.makeViewController(e,t),t.willSelect=e.willSelect||function(){},t.didSelect=e.didSelect||function(){},t.willUnselect=e.willUnselect||function(){},t.didUnselect=e.didUnselect||function(){},t.contentElement=void 0,t.tabs=[],t.selected=-1;var i=t.loadView;return t.loadView=function(e){i.call(t,e,function(){t.contentElement=t.element.querySelector("view"),t.element.forEach("tabs tab",function(e){t.tabs.push({label:e.getAttribute("label"),icon:e.getAttribute("icon"),viewController:WebApp.createViewController(e.getAttribute("root")),container:document.createElement("div"),isLoaded:!1})}),t.element.forEach("tabs",function(e){e.remove()})})},t.select=function(e){0>e&&e>=t.tabs.length&&e!=t.selected||(t.selected>=0&&t.willUnselect(t.selected),t.willSelect(e),t.tabs[e].viewController.willAppear(),t.tabs[e].isLoaded||(t.contentElement.appendChild(t.tabs[e].container),t.tabs[e].viewController.loadView(t.tabs[e].container),t.tabs[e].isLoaded=!0),t.selected>=0&&t.didUnselect(t.selected),t.selected=e,t.didSelect(e),t.tabs[e].viewController.didAppear())},t},WebApp.makeNavigationViewController=function(e,t){t=WebApp.makeViewController(e,t),t.timeBeforeUnloadingView=t.options.timeBeforeUnloadingView||100,t.willChangeTop=t.options.willChangeTop||function(){},t.didChangeTop=t.options.didChangeTop||function(){},t.willPush=t.options.willPush||function(){},t.didPush=t.options.didPush||function(){},t.willPop=t.options.willPop||function(){},t.didPop=t.options.didPop||function(){},t.contentElement,t.history=[];var i=t.loadView;return t.loadView=function(e){i.call(t,e,function(){t.contentElement=t.element.querySelector("view");var e=t.contentElement.getAttribute("top");e&&t.push(WebApp.createViewController(e)),t.contentElement.removeAttribute("top")})},t.push=function(e){e.navigationViewController=t,t.willPush(e),t.willChangeTop(),e.willAppear(),t.history.push(e);var i=document.createElement("div");e.loadView(i,function(){t.contentElement.appendChild(i),t.didPush(e),t.didChangeTop(),e.didAppear()})},t.pop=function(){var e=t.top();if(e){t.willPop(e),t.willChangeTop(),t.history.pop();var i=t.top();i&&i.willAppear(),t.didPop(e),t.didChangeTop(),i&&i.didAppear(),setTimeout(function(){e.willUnload(),e.element.remove(),e.didUnload()},t.timeBeforeUnloadingView)}},t.top=function(){return 0!==t.history.length?t.history[t.history.length-1]:void 0},t},WebApp.makeModalViewController=function(e,t){return t=WebApp.makeViewController(e,t),t.open=t.options.open||function(){},t.close=t.options.close||function(){},t.willOpen=t.options.willOpen||function(){},t.didOpen=t.options.didOpen||function(){},t.willClose=t.options.willClose||function(){},t.didClose=t.options.didClose||function(){},t},WebApp.makePopupViewController=function(e,t){return t=WebApp.makeViewController(e,t),t.parentViewController=void 0,t.openIn=t.options.openIn||function(e){t.parentViewController=e,t.willOpen(),t.didOpen()},t.close=t.options.close||function(){t.willClose(),t.didClose()},t.willOpen=t.options.willOpen||function(){},t.didOpen=t.options.didOpen||function(){},t.willClose=t.options.willClose||function(){},t.didClose=t.options.didClose||function(){},t},WebApp.loadTemplate=function(e){return{into:function(t,i){var n=new XMLHttpRequest;n.onload=function(){t.innerHTML=this.responseText,i&&i()},n.open("get",e,!0),n.send()}}},HTMLElement.prototype.forEach=function(e,t){var i=this.querySelectorAll(e);Array.prototype.slice.call(i).forEach(t)};